<div class="page-container">
    <div class="background-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
    </div>

    <div class="content-wrapper">
        <mat-card class="create-card">
            <div class="card-decoration"></div>

            <mat-card-header>
                <div class="icon-wrapper">
                    <mat-icon>add_task</mat-icon>
                </div>
                <mat-card-title>Create New Project</mat-card-title>
                <mat-card-subtitle>Launch a new initiative for your team</mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>
                <form [formGroup]="createProjectForm" (ngSubmit)="onSubmit()" class="project-form">

                    <div class="form-group">
                        <label class="input-label">Select Team</label>
                        <mat-form-field appearance="outline" class="custom-field">
                            <mat-icon matPrefix>groups</mat-icon>
                            <mat-select formControlName="teamId" placeholder="Choose a team">
                                @for (team of teams(); track team.id) {
                                <mat-option [value]="team.id">
                                    {{ team.name }} (ID: {{ team.id }})
                                </mat-option>
                                } @empty {
                                <mat-option disabled>No teams found</mat-option>
                                }
                            </mat-select>

                            @if (createProjectForm.get('teamId')?.hasError('required') &&
                            createProjectForm.get('teamId')?.touched) {
                            <mat-error>Please select a team</mat-error>
                            }
                        </mat-form-field>
                    </div>

                    <div class="form-group">
                        <label class="input-label" for="name">Project Name</label>
                        <mat-form-field appearance="outline" class="custom-field">
                            <mat-icon matPrefix>label</mat-icon>
                            <input matInput id="name" formControlName="name" placeholder="Ex: Website Redesign">

                            @if (createProjectForm.get('name')?.hasError('required') &&
                            createProjectForm.get('name')?.touched) {
                            <mat-error>Project name is required</mat-error>
                            }
                            @if (createProjectForm.get('name')?.hasError('minlength')) {
                            <mat-error>Name must be at least 3 characters</mat-error>
                            }
                        </mat-form-field>
                    </div>

                    <div class="form-group">
                        <label class="input-label" for="description">Description</label>
                        <mat-form-field appearance="outline" class="custom-field">
                            <mat-icon matPrefix class="textarea-icon">description</mat-icon>
                            <textarea matInput id="description" formControlName="description" rows="4"
                                placeholder="Describe the project goals..."></textarea>

                            @if (createProjectForm.get('description')?.hasError('required') &&
                            createProjectForm.get('description')?.touched) {
                            <mat-error>Description is required</mat-error>
                            }
                        </mat-form-field>
                    </div>

                    <div class="form-actions">
                        <a routerLink="/projects" mat-button class="cancel-btn">Cancel</a>
                        <button mat-flat-button type="submit" class="submit-btn"
                            [disabled]="createProjectForm.invalid || isLoading">

                            @if (isLoading) {
                            <mat-spinner diameter="24" class="button-spinner"></mat-spinner>
                            Creating...
                            } @else {
                            Create Project
                            }
                        </button>
                    </div>

                </form>
            </mat-card-content>
        </mat-card>
    </div>
</div>